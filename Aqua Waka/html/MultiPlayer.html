<!DOCTYPE html>
<html>
<head>
	<title>Multiplayer</title>
	<script type="text/javascript" src="js/libs/jquery/jquery-2.1.4.min.js"></script>
	<link rel="icon" href="../sources/aquawakaICON.png">
    <link rel="stylesheet" type="text/css" href="../css/gamescreen.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <script type="text/javascript" src="js/mifacebook.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase.js"></script>
    <!-- JS -->
    <script  script type="text/javascript" src="js/libs/jquery/Timmer.js"></script>
	<script  script type="text/javascript" src="js/libs/jquery/Firebase.js"></script>


	<script type="text/javascript" src="js/libs/three/three2.js"></script>
	<!-- <script type="text/javascript" src="js/libs/three/three.js"></script> -->
	<script type="text/javascript" src="js/libs/three/MTLLoader.js"></script>
	<script type="text/javascript" src="js/libs/three/OBJLoader.js"></script>
	<script type="text/javascript" src="js/libs/three/FBXLoader.js"></script>
	<script type="text/javascript" src="js/libs/three/inflate.min.js"></script>

	<script  script type="text/javascript" src="js/libs/jquery/Puntos.js"></script>

	<script id="shader-vs" type="x-shader/x-vertex">
		varying vec3 lightdir;
 		varying vec3 eyenorm;
		 varying vec2 vUv;
 		uniform vec3 lightpos;
 		void main() {
			 vUv=uv;
 		gl_Position = projectionMatrix* modelViewMatrix * vec4( position, 1.0);
		
 		vec4 tmp = modelViewMatrix * vec4 (lightdir, 1.0);
 		lightdir = tmp.xyz;
		
 		eyenorm = normalMatrix * normal;
 		}
	</script>
	
	<script id="shader-fs" type="x-shader/x-fragment">
		varying vec3 lightdir;
 		varying vec3 eyenorm;
		 varying vec2 vUv;
		uniform sampler2D	Textura;
		uniform vec2 uvOffset;
		uniform vec3 luz;

			
 		void main() {
 		       vec3 lightdir = luz;
		//float4 texAlbedo= Textura.Sample(colorSampler, 0.0);
 		float ndotl = dot (normalize (eyenorm), normalize (lightdir));
 		if (ndotl > 0.8) {
 			ndotl = 1.0;
 		} else if (ndotl > 0.6) {
 			ndotl = 0.6;
 		} else {
 			ndotl = 0.2;
 		}
 		gl_FragColor =texture2D(Textura, vUv + uvOffset)*(vec4 (ndotl, ndotl, ndotl, 1.0));
 		}
	    
	</script>

	<script type="text/javascript">

        $("#btnUp").click(function(){
            shareFB();
        });

        function shareFB() {
            // alert("exito");
		    var score = $("#scoreVictory").text();
            var name = $("#usernameinput").val();
            debugger;
		    shareScore(name,score);
	    }             
		$("btnPBack").click(function(){
            salir();
        });

        function salir(){
             if (confirm("Quiere salir del juego?")) {
                location.href ="Beginplay.html";
            } else {

            }
        }      
    </script>

	<script type="text/javascript">
		
		var scene, camera, renderer; 
		var controls, clock, deltaTime;
		var objects = [];
		var keys = {};
		var objectMov; 
		var cube, cube2, cubeSmash1, cubeSmash2;
		var isWorldReady = [false, false];
		var texturewater;
		var objs = [];
		var cubesCol = [], cubesMov = [];
		var mov = [];
		var i = 0;
		var cambioNiveles = 0;
		var contadores = [];
		var movpos;
		//Colisiones var
		var collidableMeshList = [];

		var perdiste;
		var puntaje = 0;
		var puntajeP2 = 0;
		var puntajeGeneral= 0;

		for(i = 1; i< 30; i++){
			contadores[i] = false
		}

		var onControl = false

		var gamepad={};



		$(document).ready(function(){

			window.addEventListener('gamepadconnected', event => {
			    console.log("Control Conectado.");
			    console.log(event.gamepad);

			    onControl = true;
			});

			window.addEventListener('gamepaddisconnected', event => {
			    console.log("Control Desconectado");

			    onControl = false;
			});

	//Musica arreglada
        var musicastop = localStorage.getItem('musica');

        if (musicastop == 'verdadero')
        {
            document.getElementById("musicBegin").play();
        }

        if (musicastop == 'falso')
        {
            document.getElementById("musicBegin").pause();
        }
			setupScene();

			loadOBJWithMTL("assets/Island/", "Island.obj", "Island.mtl", (object) => {

				object.position.z = -40;

				object.position.y = -1;

				// object.rotation.y = THREE.Math.degToRad(-90);
				object.scale.x = 4.0;
				object.scale.y = 3.5;
				object.scale.z = 4.0;

				object.rotation.y = THREE.Math.degToRad(90);

				var materialshader = new THREE.ShaderMaterial({
					uniforms: {
						Textura: { type: "t", value: THREE.ImageUtils.loadTexture( "assets/Island/texturatotal2.png" ) },
						uvOffset : { type : 'v', value : new THREE.Vector2(0,0)},
						luz : { type : 'v', value : new THREE.Vector3(1,1,1)}
 						},
					vertexShader : document.getElementById("shader-vs").textContent,
					fragmentShader : document.getElementById("shader-fs").textContent,
					wrapping: THREE.ClampToEdgeWrapping,
   					shading: THREE.SmoothShading,
   					side: THREE.DoubleSide,
					transparent:true
				});

				object.traverse(function(child) {
    			    if (child instanceof THREE.Mesh) {
    			        child.material =materialshader;
    			    }
    			});

				//var isla3 = object.clone();
				scene.add(object);

				isWorldReady[0] = true;
			});

			//New Isla Left
			loadOBJWithMTL("assets/Island/", "newisland.obj", "newisland.mtl", (object) => {

				object.position.x = -60; 
				object.position.y = -0.5;
				object.position.z = -2; //delante(+) y atras(-)
				
				object.scale.x = 3.0;
				object.scale.y = 2.5;
				object.scale.z = 3.0;

				object.rotation.y = THREE.Math.degToRad(112);

				var materialshader = new THREE.ShaderMaterial({
					uniforms: {
						Textura: { type: "t", value: THREE.ImageUtils.loadTexture( "assets/Island/texturatotal.png" ) },
						uvOffset : { type : 'v', value : new THREE.Vector2(0,0)}
 						},
					vertexShader : document.getElementById("shader-vs").textContent,
					fragmentShader : document.getElementById("shader-fs").textContent,
					wrapping: THREE.ClampToEdgeWrapping,
   					shading: THREE.SmoothShading,
   					side: THREE.DoubleSide,
					transparent:true
				});

				object.traverse(function(child) {
    			    if (child instanceof THREE.Mesh) {
    			        child.material =materialshader;
    			    }
    			});

				scene.add(object);
			});

			loadOBJWithMTL("assets/pokeisla/", "KittyIsland.obj", "KittyIsland.mtl", (object) => {

				object.position.x = -70; 
				object.position.y = -12;
				object.position.z = -60; //delante(+) y atras(-)
				
				object.scale.x = 3.0;
				object.scale.y = 3.0;
				object.scale.z = 3.0;

				var materialshader = new THREE.ShaderMaterial({
					uniforms: {
						Textura: { type: "t", value: THREE.ImageUtils.loadTexture( "assets/pokeisla/lambert2.png" ) },
						uvOffset : { type : 'v', value : new THREE.Vector2(0,0)}
 						},
					vertexShader : document.getElementById("shader-vs").textContent,
					fragmentShader : document.getElementById("shader-fs").textContent,
					wrapping: THREE.ClampToEdgeWrapping,
   					shading: THREE.SmoothShading,
   					side: THREE.DoubleSide,
					transparent:true
				});

				object.traverse(function(child) {
    			    if (child instanceof THREE.Mesh) {
    			        child.material =materialshader;
    			    }
    			});

				var isla2 = object.clone();
				isla2.position.x = 80;
				object.rotation.y = THREE.Math.degToRad(-50);

				object.rotation.y = THREE.Math.degToRad(50);

				scene.add(object);
				scene.add(isla2);
			});

			loadOBJWithMTL("assets/barcopirata/", "PirateShip.obj", "PirateShip.mtl", (object) => {

				object.position.x = 52;
				object.position.y = -6; 
				object.position.z = 7; //delante(+) y atras(-)
				
				object.scale.x = 2.0;
				object.scale.y = 2.0;
				object.scale.z = 2.0;

				object.rotation.y = THREE.Math.degToRad(180);
				object.rotation.x = THREE.Math.degToRad(-4);
				scene.add(object);
			});

			loadOBJWithMTL("assets/roca/", "roca.obj", "roca.mtl", (object) => {

				object.position.x = -50;
				object.position.y = -5; 
				object.position.z = 38; //delante(+) y atras(-)
				
				object.scale.x = 2.5;
				object.scale.y = 2.5;
				object.scale.z = 2.5;

				var roca2 = object.clone();
				object.position.x = 50;
				object.position.y = -5; 
				object.position.z = 35;

				object.rotation.y = THREE.Math.degToRad(180);

				scene.add(object);
				scene.add(roca2);
			});

			loadOBJWithMTL("assets/salvavidas/", "salva.obj", "salva.mtl", (object) => {

				object.position.x = 30;
				object.position.y = 2; 
				object.position.z = 45; //delante(+) y atras(-)
				
				object.scale.x = 1.2;
				object.scale.y = 1.2;
				object.scale.z = 1.2;

				var materialshader = new THREE.ShaderMaterial({
					uniforms: {
						Textura: { type: "t", value: THREE.ImageUtils.loadTexture( "assets/salvavidas/salva.png" ) },
						uvOffset : { type : 'v', value : new THREE.Vector2(0,0)}
 						},
					vertexShader : document.getElementById("shader-vs").textContent,
					fragmentShader : document.getElementById("shader-fs").textContent,
					wrapping: THREE.ClampToEdgeWrapping,
   					shading: THREE.SmoothShading,
   					side: THREE.DoubleSide,
					transparent:true
				});

				object.traverse(function(child) {
    			    if (child instanceof THREE.Mesh) {
    			        child.material =materialshader;
    			    }
    			});

				scene.add(object);
				
			});

			loadOBJWithMTL("assets/", "KO_Hammer_Brawl.obj", "KO_Hammer_Brawl.mtl", (object) => {

				object.scale.x = 0.4;
				object.scale.y = 0.4;
				object.scale.z = 0.4;

				cube.add(object);

			});

            loadOBJWithMTL("assets/", "KO_Hammer_Brawl2.obj", "KO_Hammer_Brawl2.mtl", (object) => {
				
				object.scale.x = 0.4;
				object.scale.y = 0.4;
				object.scale.z = 0.4;

				cube2.add(object);
				

			});

			//Water
			texturewater = new THREE.TextureLoader().load("../sources/water.png");
			texturewater.wrapS = texturewater.wrapT = THREE.RepeatWrapping;
			texturewater.repeat.set(0.6,0.6);

			var floorMaterial = new THREE.MeshBasicMaterial({map: texturewater, side: THREE.DoubleSide});
			var floorGeometry = new THREE.PlaneGeometry(300, 200, 10, 10);
			var floor = new THREE.Mesh(floorGeometry, floorMaterial);
			floor.position.y = -0.12;
			floor.rotation.x = Math.PI /2;
			scene.add(floor);
			
			render();
			document.addEventListener('keydown', onKeyDown);
			document.addEventListener('keyup', onKeyUp);	

			//------------Skydome--------------
			createSkydome();
			
    		//========================CARGA DE FBX

			//Piranha
			var loader = new THREE.FBXLoader();
			loader.load('assets/FBX/Pira.fbx', model => {
				var mixer = new THREE.AnimationMixer(model);

				//Scale
				model.scale.x = 1.20;
				model.scale.y = 1.20;
				model.scale.z = 1.20;

				//Position
				model.position.z = 28; //frente(+) + atras(-)
				model.position.x = 25; //izq(-) + der(+)
				model.position.y = -1;

				//Rotation
				model.rotation.x = THREE.Math.degToRad(-25);

				var action = mixer.clipAction(model.animations[0]);

				// scene.add(model);
				action.play();
				action.setLoop(THREE.Loop);
				action.timeScale = 500;
				objs.push({model, mixer});
				model.name = "Pirana";
			});

			//[NIVEL 1]
			//FRENTE
			ModelsFbx('assets/FBX/AnimacionesGlobo.fbx', 0, 0.5, 0, 'Globo', loader, 0.20, 0.20,0.20,-25, -90, cubesMov[2]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[3]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[4]);

			//Medio
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[5]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[6]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[7]);
			
			//ATRAS
			ModelsFbx('assets/FBX/AnimacionesGlobo.fbx', 0, 0.5, 0, 'Globo', loader, 0.20, 0.20,0.20,-25, -90, cubesMov[8]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx',0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[9]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx',0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[10]);

			//----------------[Nivel 2]
			//FRENTE
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, -0.7, 'Pulpo', loader, 0.55, 0.55,0.55, -25, 0, cubesMov[11]);
			ModelsFbx('assets/FBX/Pira.fbx', 0, 0.5, -0.4, 'Piranha', loader, 0.20, 0.20,0.20,-25, 0, cubesMov[12]);
			ModelsFbx('assets/FBX/AnimacionesGlobo.fbx', 0, 0.5, -0.7, 'Globo', loader, 0.20, 0.20,0.20,-25, -90, cubesMov[13]);

			//Medio
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0.5, 0.5, -0.3, 'Pulpo', loader, 0.55, 0.55,0.55, -25, 0,cubesMov[14]);
			ModelsFbx('assets/FBX/Pira.fbx', 0, 0.5, -0.2, 'Piranha', loader, 0.20, 0.20,0.20, -25, 0, cubesMov[15]);
			ModelsFbx('assets/FBX/Pira.fbx', 0, 0.5, 0, 'Piranha', loader, 0.20, 0.20,0.20, -25, 0, cubesMov[16]);

			//ATRAS
			ModelsFbx('assets/FBX/AnimacionesGlobo.fbx', 0, 0.5, -1.3, 'Globo', loader, 0.20, 0.20,0.20,-25, -90, cubesMov[17]);
			ModelsFbx('assets/FBX/Pira.fbx', 0, 0.5, 0.2, 'Piranha', loader, 0.20, 0.20,0.20,-25, 0, cubesMov[18]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55,-25, 0, cubesMov[19]);


			//----------------[Nivel 3]
			//FRENTE
			ModelsFbx('assets/FBX/Pira.fbx', 0, 0.5, 0, 'Piranha', loader, 0.20, 0.20,0.20,-25, 0, cubesMov[20]);
			ModelsFbx('assets/FBX/AnimacionesTiburon.fbx', 0, 0.5, 0, 'Tiburon', loader, 0.035, 0.035,0.035, -55, -45, cubesMov[21]);
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, 0, 'Pulpo', loader, 0.55, 0.55,0.55, -25, 0, cubesMov[22]);
			

			//Medio
			ModelsFbx('assets/FBX/Pira.fbx', 0, 0.5, 0, 'Piranha', loader, 0.20, 0.20,0.20,-25, 0, cubesMov[23]);
			ModelsFbx('assets/FBX/AnimacionesTiburon.fbx', 0, 0.5, 0, 'Tiburon', loader, 0.040, 0.040,0.040, -55, -45, cubesMov[24]);
			ModelsFbx('assets/FBX/LightFish.fbx', 0, 0.5, 0, 'LightFish', loader, 0.20, 0.20,0.20,-5, 0, cubesMov[25]);

			//ATRAS
			ModelsFbx('assets/FBX/AnimacionesPulpoHelp.fbx', 0, 0.5, -0.6, 'Pulpo', loader, 0.55, 0.55,0.55, -25, 0, cubesMov[26]);
			ModelsFbx('assets/FBX/LightFish.fbx', 0, 0.5, 0, 'LightFish', loader, 0.20, 0.20,0.20,-5, 0, cubesMov[27]);
			ModelsFbx('assets/FBX/AnimacionesTiburon.fbx', 0, 0.5, 0, 'Tiburon', loader, 0.04, 0.04,0.04, -35, -45, cubesMov[28]);



			//LightFish
			loader.load('assets/FBX/LightFish.fbx', model => {
				var mixer = new THREE.AnimationMixer(model);

				//Scale
				model.scale.x = 1.20;
				model.scale.y = 1.20;
				model.scale.z = 1.20;

				//Position
				model.position.z = 25; //frente(+) + atras(-)
				model.position.x = 0; //izq(-) + der(+)
				model.position.y = 2.5;

				//Rotation
				model.rotation.x = THREE.Math.degToRad(-5);

				var action = mixer.clipAction(model.animations[0]);

				// scene.add(model);
				action.play();
				action.setLoop(THREE.Loop);
				action.timeScale = 500;
				objs.push({model, mixer});
				model.name = "Lightfish";
			});

		});

		function ModelsFbx(nombreArchivo, positionx, positiony, positionz,
		 name, loader, scalax, scalay, scalaz, rotationx, rotationy, pcubemove){

			loader.load(nombreArchivo, model => {
				var mixer = new THREE.AnimationMixer(model);

				//Scale
				model.scale.x = scalax;
				model.scale.y = scalay;
				model.scale.z = scalaz;

				//Position
				model.position.z = positionz; //frente(+) + atras(-)
				model.position.x = positionx; //izq(-) + der(+)
				model.position.y = positiony;

				//Rotation
				model.rotation.y = THREE.Math.degToRad(rotationy);
				model.rotation.x = THREE.Math.degToRad(rotationx);

				var action = mixer.clipAction(model.animations[0]);

				pcubemove.add(model);
				action.play();
				action.setLoop(THREE.Loop);
				action.timeScale = 500;
				objs.push({model, mixer});
				model.name = name;
			});
		}

		function loadOBJWithMTL(path, objFile, mtlFile, onLoadCallback) {
			var mtlLoader = new THREE.MTLLoader();
			mtlLoader.setPath(path);
			mtlLoader.load(mtlFile, (materials) => {
				
				var objLoader = new THREE.OBJLoader();
				objLoader.setMaterials(materials);
				objLoader.setPath(path);
				objLoader.load(objFile, (object) => {
					onLoadCallback(object);
				});

			});
		}	

		function onKeyDown(event) {
			keys[String.fromCharCode(event.keyCode)] = true;
		}
		function onKeyUp(event) {
			keys[String.fromCharCode(event.keyCode)] = false;
		}

		function render(){
			requestAnimationFrame(render);
			deltaTime = clock.getDelta();	

			gamepad=navigator.getGamepads();

			var yaw = 0, yaw2 = 0;
			var forward = 0, forward2 = 0;

			if (keys["A"]) {
				yaw = -20;
			} else if (keys["D"]) {
				yaw = 20;
			}
			if (keys["W"]) {
				forward = -20;
			} else if (keys["S"]) {
				forward = 20;
			}

			if(keys["X"]){
				cube.rotation.x = THREE.Math.degToRad(-90);
				Colisiona(cubeSmash1);
				yaw = 0;
				forward = 0;
			}else {
				
				cube.rotation.x = THREE.Math.degToRad(0);
			}

			//CAMBIO DE NIVEL POR TECLAS
			if(keys["Y"]){
				//movpos = 20;
				cambioNiveles = 1;
			}else if (keys["H"]){
				//movpos = -20;
				cambioNiveles = 2;
			}


            //Segundo martillo

			if(onControl==false){
				if (keys["J"]) {
					yaw2 = -20;
				} else if (keys["L"]) {
					yaw2 = 20;
				}
				if (keys["I"]) {
					forward2 = -20;
				} else if (keys["K"]) {
					forward2 = 20;
				}

				if(keys["N"]){
					cube2.rotation.x = THREE.Math.degToRad(-90);
					Colisiona2(cubeSmash2);
					yaw2 = 0;
					forward2 = 0;
				}else {

					cube2.rotation.x = THREE.Math.degToRad(0);
				}
			}
			else{
				if (gamepad[0].buttons[14].pressed) {
					yaw2 = -20;
				} else if (gamepad[0].buttons[15].pressed) {
					yaw2 = 20;
				}
				if (gamepad[0].buttons[12].pressed) {
					forward2 = -20;
				} else if (gamepad[0].buttons[13].pressed) {
					forward2 = 20;
				}

				if(gamepad[0].buttons[0].pressed){
					cube2.rotation.x = THREE.Math.degToRad(-90);
					Colisiona2(cubeSmash2);
					yaw2 = 0;
					forward2 = 0;
				}else {

					cube2.rotation.x = THREE.Math.degToRad(0);
				}
			}

            
			

			//Primer nivel
			if(cambioNiveles == 0){

			// Pez10
				if(contadores[10] == false){
					if(cubesMov[10].position.y < -1)
					cubesMov[10].position.y += 0.1;
					else
					contadores[10] = true;
				}

				if(contadores[10] == true){
					cubesMov[10].position.y -= 0.1;
					if(cubesMov[10].position.y <= -11)
					contadores[10] = false;
				}

				//Pez2
				if(contadores[2] == false){
					if(cubesMov[2].position.y < -1)
					cubesMov[2].position.y += 0.1;
					else
					contadores[2] = true;
				}

				if(contadores[2] == true){
					cubesMov[2].position.y -= 0.1;
					if(cubesMov[2].position.y <= -14)
					contadores[2] = false;
				}

				// Pez3
				if(contadores[3] == false){
					if(cubesMov[3].position.y < -1)
					cubesMov[3].position.y += 0.1;
					else
					contadores[3] = true;
				}

				if(contadores[3] == true){
					cubesMov[3].position.y -= 0.1;
					if(cubesMov[3].position.y <= -12)
					contadores[3] = false;
				}

				// Pez4
				if(contadores[4] == false){
					if(cubesMov[4].position.y < -1)
					cubesMov[4].position.y += 0.1;
					else
					contadores[4] = true;
				}

				if(contadores[4] == true){
					cubesMov[4].position.y -= 0.1;
					if(cubesMov[4].position.y <= -15)
					contadores[4] = false;
				}

				// Pez5
				if(contadores[5] == false){
					if(cubesMov[5].position.y < -1)
					cubesMov[5].position.y += 0.1;
					else
					contadores[5] = true;
				}

				if(contadores[5] == true){
					cubesMov[5].position.y -= 0.1;
					if(cubesMov[5].position.y <= -16)
					contadores[5] = false;
				}

				// Pez6
				if(contadores[6] == false){
					if(cubesMov[6].position.y < -1)
					cubesMov[6].position.y += 0.1;
					else
					contadores[6] = true;
				}

				if(contadores[6] == true){
					cubesMov[6].position.y -= 0.1;
					if(cubesMov[6].position.y <= -9)
					contadores[6] = false;
				}

				// Pez7
				if(contadores[7] == false){
					if(cubesMov[7].position.y < -1)
					cubesMov[7].position.y += 0.1;
					else
					contadores[7] = true;
				}

				if(contadores[7] == true){
					cubesMov[7].position.y -= 0.1;
					if(cubesMov[7].position.y <= -10)
					contadores[7] = false;
				}

				// Pez8
				if(contadores[8] == false){
					if(cubesMov[8].position.y < -1)
					cubesMov[8].position.y += 0.1;
					else
					contadores[8] = true;
				}

				if(contadores[8] == true){
					cubesMov[8].position.y -= 0.1;
					if(cubesMov[8].position.y <= -17)
					contadores[8] = false;
				}

				// Pez9
				if(contadores[9] == false){
					if(cubesMov[9].position.y < -1)
					cubesMov[9].position.y += 0.1;
					else
					contadores[9] = true;
				}

				if(contadores[9] == true){
					cubesMov[9].position.y -= 0.1;
					if(cubesMov[9].position.y <= -10)
					contadores[9] = false;
				}

				perdiste = n-1;

				if(perdiste > 20){

					if(puntaje > 200){ //200 por que es multiplayer
						n = 0;
						$("#Nivelfont").html("<p>LEVEL: 2</p>");
						cambioNiveles = 1;
					}else{
						PausaGame();
						$('#exampleModal3').modal('show');
					}
				
				}

				//Para que no se vea bajar los modelos del nivel 2 y 3 
				cubesMov[20].position.y = -20;
				cubesMov[21].position.y = -20;
				cubesMov[22].position.y = -20;
				cubesMov[23].position.y = -20;
				cubesMov[24].position.y = -20;
				cubesMov[25].position.y = -20;
				cubesMov[26].position.y = -20;
				cubesMov[27].position.y = -20;
				cubesMov[28].position.y = -20;

				cubesMov[11].position.y = -20;
				cubesMov[12].position.y = -20;
				cubesMov[13].position.y = -20;
				cubesMov[14].position.y = -20;
				cubesMov[15].position.y = -20;
				cubesMov[16].position.y = -20;
				cubesMov[17].position.y = -20;
				cubesMov[18].position.y = -20;
				cubesMov[19].position.y = -20;

			}

			if(cambioNiveles == 1){
				//Se bajan los del nivel 1 
				cubesMov[2].position.y = -20;
				cubesMov[3].position.y = -20;
				cubesMov[4].position.y = -20;
				cubesMov[5].position.y = -20;
				cubesMov[6].position.y = -20;
				cubesMov[7].position.y = -20;
				cubesMov[8].position.y = -20;
				cubesMov[9].position.y = -20;
				cubesMov[10].position.y = -20;
				
				
				//Suben nivel 2 Esto se debera cambiar por lo del movimiento, pero por pruebas lo deje así 
				// cubesMov[11].position.y = 1;
				// cubesMov[12].position.y = 1;
				// cubesMov[13].position.y = 1;
				// cubesMov[14].position.y = 1;
				// cubesMov[15].position.y = 1;
				// cubesMov[16].position.y = 1;
				// cubesMov[17].position.y = 1;
				// cubesMov[18].position.y = 1;
				// cubesMov[19].position.y = 1;

				//Pez 11
				if(contadores[11] == false){
					if(cubesMov[11].position.y < -1)
					cubesMov[11].position.y += 0.1;
					else
					contadores[11] = true;
				}

				if(contadores[11] == true){
					cubesMov[11].position.y -= 0.1;
					if(cubesMov[11].position.y <= -14)
					contadores[11] = false;
				}

				// Pez 12
				if(contadores[12] == false){
					if(cubesMov[12].position.y < -1)
					cubesMov[12].position.y += 0.1;
					else
					contadores[12] = true;
				}

				if(contadores[12] == true){
					cubesMov[12].position.y -= 0.1;
					if(cubesMov[12].position.y <= -12)
					contadores[12] = false;
				}

				// Pez 13
				if(contadores[13] == false){
					if(cubesMov[13].position.y < -1)
					cubesMov[13].position.y += 0.1;
					else
					contadores[13] = true;
				}

				if(contadores[13] == true){
					cubesMov[13].position.y -= 0.1;
					if(cubesMov[13].position.y <= -15)
					contadores[13] = false;
				}

				// Pez 14
				if(contadores[14] == false){
					if(cubesMov[14].position.y < -1)
					cubesMov[14].position.y += 0.1;
					else
					contadores[14] = true;
				}

				if(contadores[14] == true){
					cubesMov[14].position.y -= 0.1;
					if(cubesMov[14].position.y <= -16)
					contadores[14] = false;
				}

				// Pez 15
				if(contadores[15] == false){
					if(cubesMov[15].position.y < -1)
					cubesMov[15].position.y += 0.1;
					else
					contadores[15] = true;
				}

				if(contadores[15] == true){
					cubesMov[15].position.y -= 0.1;
					if(cubesMov[15].position.y <= -9)
					contadores[15] = false;
				}

				// Pez 16
				if(contadores[16] == false){
					if(cubesMov[16].position.y < -1)
					cubesMov[16].position.y += 0.1;
					else
					contadores[16] = true;
				}

				if(contadores[16] == true){
					cubesMov[16].position.y -= 0.1;
					if(cubesMov[16].position.y <= -10)
					contadores[16] = false;
				}

				// Pez 17
				if(contadores[17] == false){
					if(cubesMov[17].position.y < -1)
					cubesMov[17].position.y += 0.1;
					else
					contadores[17] = true;
				}

				if(contadores[17] == true){
					cubesMov[17].position.y -= 0.1;
					if(cubesMov[17].position.y <= -17)
					contadores[17] = false;
				}

				// Pez 18
				if(contadores[18] == false){
					if(cubesMov[18].position.y < -1)
					cubesMov[18].position.y += 0.1;
					else
					contadores[18] = true;
				}

				if(contadores[18] == true){
					cubesMov[18].position.y -= 0.1;
					if(cubesMov[18].position.y <= -10)
					contadores[18] = false;
				}

				// Pez 19
				if(contadores[19] == false){
					if(cubesMov[19].position.y < -1)
					cubesMov[19].position.y += 0.1;
					else
					contadores[19] = true;
				}

				if(contadores[19] == true){
					cubesMov[19].position.y -= 0.1;
					if(cubesMov[19].position.y <= -11)
					contadores[19] = false;
				}

				perdiste = n-1;
				if(perdiste > 20){
					if(puntaje > 600){
						n = 0;
						$("#Nivelfont").html("<p> LEVEL: 3 </p>");
						cambioNiveles = 2;

					}else{
						PausaGame();
						$('#exampleModal3').modal('show');
					}
				}


				//Secuencia para hacer que suban y bajen los del nivel 2 
			}

			if(cambioNiveles == 2){
				 //Se bajan los del nivel 2
				cubesMov[11].position.y = -20;
				cubesMov[12].position.y = -20;
				cubesMov[13].position.y = -20;
				cubesMov[14].position.y = -20;
				cubesMov[15].position.y = -20;
				cubesMov[16].position.y = -20;
				cubesMov[17].position.y = -20;
				cubesMov[18].position.y = -20;
				cubesMov[19].position.y = -20;

				//Subir nivel 3 Esto se debera cambiar por lo del movimiento, pero por pruebas lo deje así 
				// cubesMov[20].position.y = 1;
				// cubesMov[21].position.y = 1;
				// cubesMov[22].position.y = 1;
				// cubesMov[23].position.y = 1;
				// cubesMov[24].position.y = 1;
				// cubesMov[25].position.y = 1;
				// cubesMov[26].position.y = 1;
				// cubesMov[27].position.y = 1;
				// cubesMov[28].position.y = 1;
				//Pez 20
				if(contadores[20] == false){
					if(cubesMov[20].position.y < -1)
					cubesMov[20].position.y += 0.1;
					else
					contadores[20] = true;
				}

				if(contadores[20] == true){
					cubesMov[20].position.y -= 0.1;
					if(cubesMov[20].position.y <= -14)
					contadores[20] = false;
				}

				// Pez 21
				if(contadores[21] == false){
					if(cubesMov[21].position.y < -1)
					cubesMov[21].position.y += 0.1;
					else
					contadores[21] = true;
				}

				if(contadores[21] == true){
					cubesMov[21].position.y -= 0.1;
					if(cubesMov[21].position.y <= -12)
					contadores[21] = false;
				}

				// Pez 22
				if(contadores[22] == false){
					if(cubesMov[22].position.y < -1)
					cubesMov[22].position.y += 0.1;
					else
					contadores[22] = true;
				}

				if(contadores[22] == true){
					cubesMov[22].position.y -= 0.1;
					if(cubesMov[22].position.y <= -15)
					contadores[22] = false;
				}

				// Pez 23
				if(contadores[23] == false){
					if(cubesMov[23].position.y < -1)
					cubesMov[23].position.y += 0.1;
					else
					contadores[23] = true;
				}

				if(contadores[23] == true){
					cubesMov[23].position.y -= 0.1;
					if(cubesMov[23].position.y <= -16)
					contadores[23] = false;
				}

				// Pez 24
				if(contadores[24] == false){
					if(cubesMov[24].position.y < -1)
					cubesMov[24].position.y += 0.1;
					else
					contadores[24] = true;
				}

				if(contadores[24] == true){
					cubesMov[24].position.y -= 0.1;
					if(cubesMov[24].position.y <= -9)
					contadores[24] = false;
				}

				// Pez 25
				if(contadores[25] == false){
					if(cubesMov[25].position.y < -1)
					cubesMov[25].position.y += 0.1;
					else
					contadores[25] = true;
				}

				if(contadores[25] == true){
					cubesMov[25].position.y -= 0.1;
					if(cubesMov[25].position.y <= -10)
					contadores[25] = false;
				}

				// Pez 26
				if(contadores[26] == false){
					if(cubesMov[26].position.y < -1)
					cubesMov[26].position.y += 0.1;
					else
					contadores[26] = true;
				}

				if(contadores[26] == true){
					cubesMov[26].position.y -= 0.1;
					if(cubesMov[26].position.y <= -17)
					contadores[26] = false;
				}

				// Pez 27
				if(contadores[27] == false){
					if(cubesMov[27].position.y < -1)
					cubesMov[27].position.y += 0.1;
					else
					contadores[27] = true;
				}

				if(contadores[27] == true){
					cubesMov[27].position.y -= 0.1;
					if(cubesMov[27].position.y <= -10)
					contadores[27] = false;
				}	

				// Pez 28
				if(contadores[28] == false){
					if(cubesMov[28].position.y < -1)
					cubesMov[28].position.y += 0.1;
					else
					contadores[28] = true;
				}

				if(contadores[28] == true){
					cubesMov[28].position.y -= 0.1;
					if(cubesMov[28].position.y <= -11)
					contadores[28] = false;
				}

				perdiste = n-1;
				if(perdiste > 20){
					if(puntaje > 1200){
						PausaGame();
						$('#exampleModal2').modal('show');
						// cambioNiveles = 2;
					}else{
						PausaGame();
						$('#exampleModal3').modal('show');
					}
				}

			 	//Secuencia par hacer que suban y bajen los del nivel 3
			}
			

			if (isWorldReady[0]) {
				
				// camera.rotation.y += yaw * deltaTime;
				// camera.translateZ(forward * deltaTime);

				//------MAZO 1---------
                cube.translateZ( forward * deltaTime);
			    cube.translateX(yaw * deltaTime);
				cubeSmash1.translateZ( forward * deltaTime);
				cubeSmash1.translateX(yaw * deltaTime);

				//------MAZO 2----------
                cube2.translateZ( forward2 * deltaTime);
			    cube2.translateX(yaw2 * deltaTime);
				cubeSmash2.translateZ( forward2 * deltaTime);
				cubeSmash2.translateX(yaw2 * deltaTime);



			    objs.forEach(({mixer})=> {mixer.update(clock.getDelta());});
				// Mov_Y(objs[1], mov);

			}
			
			// cube.rotation.y += yaw * deltaTime; 
			
			texturewater.offset.x +=.0003;
			renderer.render(scene, camera);
			// camera.lookAt(objectMov.position);

		}

		function setupScene() {		
			var visibleSize = { width: 800, height: 400};
			clock = new THREE.Clock();		
			scene = new THREE.Scene();
			camera = new THREE.PerspectiveCamera(75, visibleSize.width / visibleSize.height, 0.1, 200);
			camera.position.z = 0;
			// camera.position.y = 5;

			renderer = new THREE.WebGLRenderer( {precision: "mediump" } );
			renderer.setClearColor(new THREE.Color(0, 1, .9));
			renderer.setPixelRatio(visibleSize.width / visibleSize.height);
			renderer.setSize(visibleSize.width, visibleSize.height);

			var ambientLight = new THREE.AmbientLight(new THREE.Color(1, 1, 1), 1.0);
			scene.add(ambientLight);

			var directionalLight = new THREE.DirectionalLight(new THREE.Color(1, 1, 0), 0.4);
			directionalLight.position.set(0, 0, 1);
			scene.add(directionalLight);

			var grid = new THREE.GridHelper(50, 10, 0xffffff, 0xffffff);
			grid.position.y = -1;
			//scene.add(grid);

			var material = new THREE.MeshPhongMaterial({
				color: new THREE.Color(0.1, 1.0, 0.0),
				opacity: .0,
				transparent: true,
			});

			var material2 = new THREE.MeshPhongMaterial({
				color: new THREE.Color(0.1, 1.0, 0.0),
				opacity: .7,
				transparent: true,
			});

			var material3 = new THREE.MeshPhongMaterial({
				color: new THREE.Color(0.1, 1.0, 1.0),
				opacity: .7,
				transparent: true,
			});

			var geometry = new THREE.BoxGeometry(1, 1, 1);
			//----------MAZO 1 ----------------
			cube = new THREE.Mesh(geometry, material)
			cube.position.y = 2;
            cube.position.x = -20;
			cube.position.z = 20;
			scene.add(cube);

			//--- Cubo golpe Mazo 1-----
			cubeSmash1 = new THREE.Mesh(geometry, material);
			cubeSmash1.scale.x = 5;
			cubeSmash1.scale.y = 5;
			cubeSmash1.scale.z = 5;

			cubeSmash1.position.y = 8.90;
			cubeSmash1.position.z = 10;
			cubeSmash1.position.x = -20;
			scene.add(cubeSmash1);

			//----------MAZO 2 ----------------
            cube2 = new THREE.Mesh(geometry, material);
			cube2.position.y = 2;
        
			cube2.position.x = 20;
			cube2.position.z = 20;

			//--- Cubo golpe Mazo 2-----
			cubeSmash2 = new THREE.Mesh(geometry, material);
			cubeSmash2.scale.x = 5;
			cubeSmash2.scale.y = 5;
			cubeSmash2.scale.z = 5;

			cubeSmash2.position.y = 8.90;
			cubeSmash2.position.z = 10;
			cubeSmash2.position.x = 20;
			scene.add(cubeSmash2);


            scene.add(cube2);


			//---CUBOS COLISION-----------
			camera.position.y = 30;
			camera.position.z = 60;


			// CUBOS DE MOVIMIENTO NIVEL 1
			cubesMov[2] = createCubesMov(geometry, material2, cubesMov[2], 0, 0.5, 38, 5, 5, 5)
			cubesMov[3] = createCubesMov(geometry, material, cubesMov[3], -20, 2, 40, 5, 5, 5)
			cubesMov[4] = createCubesMov(geometry, material, cubesMov[4], 20, 2, 40, 5, 5, 5)
			cubesMov[5] = createCubesMov(geometry, material, cubesMov[5], -25, 2, 25, 5, 5, 5)
			cubesMov[6] = createCubesMov(geometry, material, cubesMov[6], 0, 2, 25, 5, 5, 5)
			cubesMov[7] = createCubesMov(geometry, material, cubesMov[7], 25, 2, 25, 5, 5, 5)
			cubesMov[8] = createCubesMov(geometry, material, cubesMov[8], 0, 0.5, 10, 5, 5, 5)
			cubesMov[9] = createCubesMov(geometry, material, cubesMov[9], -20, 2, 10, 5, 5, 5)
			cubesMov[10] = createCubesMov(geometry, material, cubesMov[10], 20, 2, 10, 5, 5, 5)
			
			//Colisiones nivel 1
			createCubes(geometry, material, cubesCol[1], 0,2,0, 1.5, 1.5, 0.8, "Globo", cubesMov[2]);
			createCubes(geometry, material, cubesCol[2], 0,2,0, 1.5, 1.5, 1.8, "Pulpo", cubesMov[3]);
			createCubes(geometry, material, cubesCol[3], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[4]);
			createCubes(geometry, material, cubesCol[4], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[5]);
			createCubes(geometry, material, cubesCol[5], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[6]);
			createCubes(geometry, material, cubesCol[7], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[7]);
			createCubes(geometry, material, cubesCol[8], 0,2,0, 1.5, 1.5, 0.8, "Globo", cubesMov[8]);
			createCubes(geometry, material, cubesCol[9], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[9]);
			createCubes(geometry, material, cubesCol[10], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[10]);


			//Cubos de mov nivel 2
						
			cubesMov[11] = createCubesMov(geometry, material, cubesMov[11], 0, 0.5, 38, 5, 5, 5);
			cubesMov[12] = createCubesMov(geometry, material, cubesMov[12], -20, 2, 40, 5, 5, 5);
			cubesMov[13] = createCubesMov(geometry, material, cubesMov[13], 20, 2, 40, 5, 5, 5);
			cubesMov[14] = createCubesMov(geometry, material, cubesMov[14], -25, 2, 25, 5, 5, 5);
			cubesMov[15] = createCubesMov(geometry, material, cubesMov[15], 0, 2, 25, 5, 5, 5);
			cubesMov[16] = createCubesMov(geometry, material, cubesMov[16], 25, 2, 25, 5, 5, 5);
			cubesMov[17] = createCubesMov(geometry, material, cubesMov[17], 0, 0.5, 10, 5, 5, 5);
			cubesMov[18] = createCubesMov(geometry, material, cubesMov[18], -20, 2, 10, 5, 5, 5);
			cubesMov[19] = createCubesMov(geometry, material, cubesMov[19], 20, 2, 10, 5, 5, 5);
			
			//Colisiones nivel 2
			createCubes(geometry, material, cubesCol[11], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[11]);
			createCubes(geometry, material, cubesCol[12], 0,2,0, 1.5, 1.5, 1.8, "Piranha", cubesMov[12]);
			createCubes(geometry, material, cubesCol[13], 0,2,0, 1.5, 1.5, 0.8, "Globo", cubesMov[13]);
			createCubes(geometry, material, cubesCol[14], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[14]);
			createCubes(geometry, material, cubesCol[15], 0,2,0, 1.5, 1.5, 0.8, "Piranha", cubesMov[15]);
			createCubes(geometry, material, cubesCol[16], 0,2,0, 1.5, 1.5, 0.8, "Piranha", cubesMov[16]);
			createCubes(geometry, material, cubesCol[17], 0,2,0, 1.5, 1.5, 0.8, "Globo", cubesMov[17]);
			createCubes(geometry, material, cubesCol[18], 0,2,0, 1.5, 1.5, 0.8, "Piranha", cubesMov[18]);
			createCubes(geometry, material, cubesCol[19], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[19]);



			//Cubos de mov nivel 3
						
			cubesMov[20] = createCubesMov(geometry, material, cubesMov[20], 0, 0.5, 38, 5, 5, 5);
			cubesMov[21] = createCubesMov(geometry, material, cubesMov[21], -20, 2, 40, 5, 5, 5);
			cubesMov[22] = createCubesMov(geometry, material, cubesMov[22], 20, 2, 40, 5, 5, 5);
			cubesMov[23] = createCubesMov(geometry, material, cubesMov[23], -25, 2, 25, 5, 5, 5);
			cubesMov[24] = createCubesMov(geometry, material, cubesMov[24], 0, 2, 25, 5, 5, 5);
			cubesMov[25] = createCubesMov(geometry, material, cubesMov[25], 25, 2, 25, 5, 5, 5);
			cubesMov[26] = createCubesMov(geometry, material, cubesMov[26], 0, 0.5, 10, 5, 5, 5);
			cubesMov[27] = createCubesMov(geometry, material, cubesMov[27], -20, 2, 10, 5, 5, 5);
			cubesMov[28] = createCubesMov(geometry, material, cubesMov[28], 20, 2, 10, 5, 5, 5);
			
			//Colisiones nivel 3
			createCubes(geometry, material, cubesCol[20], 0,2,0, 1.5, 1.5, 0.8, "Piranha", cubesMov[20]);
			createCubes(geometry, material, cubesCol[21], 0,2,0, 1.5, 1.5, 1.8, "Tiburon", cubesMov[21]);
			createCubes(geometry, material, cubesCol[22], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[22]);
			createCubes(geometry, material, cubesCol[23], 0,2,0, 1.5, 1.5, 0.8, "Piranha", cubesMov[23]);
			createCubes(geometry, material, cubesCol[24], 0,2,0, 1.5, 1.5, 0.8, "Tiburon", cubesMov[24]);
			createCubes(geometry, material, cubesCol[25], 0,2,0, 1.5, 1.5, 0.8, "LightFish", cubesMov[25]);
			createCubes(geometry, material, cubesCol[26], 0,2,0, 1.5, 1.5, 0.8, "Pulpo", cubesMov[26]);
			createCubes(geometry, material, cubesCol[27], 0,2,0, 1.5, 1.5, 0.8, "LightFish", cubesMov[27]);
			createCubes(geometry, material, cubesCol[28], 0,2,0, 1.5, 1.5, 0.8, "Tiburon", cubesMov[28]);

			
			
			camera.rotation.x = THREE.Math.degToRad(-38);  
			createParticle2(30, 8, 45);
			createParticle2(-32, 8, 45);

			$("#scene-section").append(renderer.domElement);
		}

		function createSkydome(){
			var skyDom = new THREE.SphereGeometry(166, 25 ,25);
			var loader = new THREE.TextureLoader(),
			texture = loader.load("../sources/Sky.png");
			var material = new THREE.MeshPhongMaterial({ 
        	map: texture,
			});
			var sky = new THREE.Mesh(skyDom, material);
    		sky.material.side = THREE.BackSide;
			sky.position.z = 40;
			sky.position.y = 4;
    		scene.add(sky);
		}

		function createCubes(Pgeometry, Pmaterial, Pname, Px, Py,Pz, P_sx, P_sy, P_sz, name, cubevar){

			Pname = new THREE.Mesh(Pgeometry, Pmaterial);
			Pname.position.x = Px;
			Pname.position.y = Py;
			Pname.position.z = Pz;
			

			Pname.scale.x = P_sx;
			Pname.scale.z = P_sy;
			Pname.scale.y = P_sz;

			
			// if(name == "Piranha"){ 
				// cube3.add(Pname);
			// }
			// else{
				// scene.add(Pname);
			// }
			cubevar.add(Pname);
			Pname.name = name;
			collidableMeshList.push(Pname);
		}

		function createCubesMov (Pgeometry, Pmaterial, Pcube, px, py , pz, sx, sy, sz){
			Pcube = new THREE.Mesh(Pgeometry, Pmaterial);
			// Position cubes
			Pcube.position.x = px;
			Pcube.position.y = py;
			Pcube.position.z = pz;

			// Scale cubes
			Pcube.scale.x = sx;
			Pcube.scale.y = sy;
			Pcube.scale.z = sz;

			scene.add(Pcube);

			return Pcube;
		}

		function Colisiona(CuboMazo){
				var originPoint = CuboMazo.position.clone();
				for(var vertexIndex = 0; vertexIndex < CuboMazo.geometry.vertices.length; vertexIndex++){
					var localVextex = CuboMazo.geometry.vertices[vertexIndex].clone();
					var globalVertex = localVextex.applyMatrix4(CuboMazo.matrix);
					var directionVector = globalVertex.sub(CuboMazo.position);

					var ray = new THREE.Raycaster(originPoint, directionVector.clone().normalize());
					var collisionResults = ray.intersectObjects(collidableMeshList);

					if(collisionResults.length > 0 && collisionResults[0].distance < directionVector.length() ){

						switch(collisionResults[0].object.name){
							case "Piranha": 
								puntaje = (puntaje + 2);
								break;	
							
							case "LightFish": 
								puntaje = (puntaje + 2);
								break;

							case "Globo": 
								puntaje = (puntaje -1);
								break;

							case "Pulpo": 
								puntaje = puntaje +1;
								break;

							case "Tiburon":
								puntaje = (puntaje + 2); 
								break;
						}
						
					$("#pts").html("<p>" + puntaje + "</p>");
					document.getElementById("scoreVictory").value = puntaje;
					document.getElementById("scoreLose").value = puntaje;
					}
				}
		}

		
		function Colisiona2(CuboMazo2){
			var originPoint = CuboMazo2.position.clone();
				for(var vertexIndex = 0; vertexIndex < CuboMazo2.geometry.vertices.length; vertexIndex++){
					var localVextex = CuboMazo2.geometry.vertices[vertexIndex].clone();
					var globalVertex = localVextex.applyMatrix4(CuboMazo2.matrix);
					var directionVector = globalVertex.sub(CuboMazo2.position);

					var ray = new THREE.Raycaster(originPoint, directionVector.clone().normalize());
					var collisionResults = ray.intersectObjects(collidableMeshList);

					if(collisionResults.length > 0 && collisionResults[0].distance < directionVector.length() ){

						switch(collisionResults[0].object.name){
							case "Piranha": 
								puntaje = (puntaje + 2);
								break;	
							
							case "LightFish": 
								puntaje = (puntaje + 2);
								break;

							case "Globo": 
								puntaje = (puntaje -1);
								break;

							case "Pulpo": 
								puntaje = puntaje +1;
								break;

							case "Tiburon": 
								puntaje = (puntaje + 2);
								break;
						}

					$("#pts").html("<p>" + puntaje + "</p>");
					document.getElementById("scoreVictory").value = puntaje;
					document.getElementById("scoreLose").value = puntaje;
					}
				}
		}
		// -------------------------------FALTA HACER ESTO -------------------------------------------------------------
		function createParticle2(Px, Py, Pz){
			particleTexture = THREE.ImageUtils.loadTexture( 'assets/spark.png' );

			particleGroup = new THREE.Object3D();
			particleAttributes = { startSize: [], startPosition: [], randomness: [] };
	
			var totalParticles = 7;
			var radiusRange = 7;
			for( var i = 0; i < totalParticles; i++ ) 
			{
				var spriteMaterial = new THREE.SpriteMaterial( { map: particleTexture, useScreenCoordinates: false, color: 0xffffff } );
				
				var sprite = new THREE.Sprite( spriteMaterial );
				sprite.scale.set( 5, 5, 1.0 ); // imageWidth, imageHeight
				sprite.position.set( Math.random() - 0.5, Math.random() - 0.5, Math.random() - 0.5 );
				// for a cube:
				// sprite.position.multiplyScalar( radiusRange );
				// for a solid sphere:
				sprite.position.setLength( radiusRange * Math.random() );
				// for a spherical shell:
				// sprite.position.setLength( radiusRange * (Math.random() * 0.1 + 0.9) );
				
				// sprite.color.setRGB( Math.random(),  Math.random(),  Math.random() ); 
				sprite.material.color.setHSL( Math.random(), 0.9, 0.7 ); 
				
				// sprite.opacity = 0.80; // translucent particles
				sprite.material.blending = THREE.AdditiveBlending; // "glowing" particles
				
				particleGroup.add( sprite );
				// add variable qualities to arrays, if they need to be accessed later
				particleAttributes.startPosition.push( sprite.position.clone() );
				particleAttributes.randomness.push( Math.random() );
			}
				
				particleGroup.position.x = Px; //30
				particleGroup.position.y = Py; //8
				particleGroup.position.z = Pz; //45
				scene.add( particleGroup );
				
	}

		function Mov_Y(Model, valor){

			if(valor > 10){
				Model.position.y -= valor; 
				valor--;	
			}else{
				Model.position.y += valor;
				valor++;	
			}
			
		}

	</script>

</head>



<body>

	<audio src="../sounds/AWmusic.mp3" preload="auto" autoplay id="musicBegin"></audio>
	<div id="scene-section" class= "Prueba" ></div>
	<div id="Colision"></div>

	<div class="container">
    	<div class="filadatos row justify-content-center">
    	</div>
    	<h4 id="timming"></h4>
        <img id="time" src="../sources/time.png" class="img-fluid">
        <h4 id="pts">0</h4>
        <h5 id="Nivelfont">LEVEL: 1</h5>
        <img id="score" src="../sources/score.png" class="img-fluid">
        <img id="titulito" src="../sources/aquawaka.png" class="img-fluid">

        <input type="image" id="btnPausa" src="../sources/btnsettings.png" data-bs-toggle="modal" data-bs-target="#exampleModal" onclick="PausaGame()">
        <input type="image" id="btnVictory" src="../sources/btnsettings.png" data-bs-toggle="modal" data-bs-target="#exampleModal2">
        <input type="image" id="btnLose" src="../sources/btnsettings.png" data-bs-toggle="modal" data-bs-target="#exampleModal3">
        </div>
    </div>


<!-- Modal Pausa-->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="background-color: rgba(0,0,0,.0001) !important; border: rgba(0,0,0,.0001) !important;">
      <div class="modal-body">
        <img id="sigpausa" class="img-fluid" src="../sources/pausa.png">
        <a >
			<input type="image" class="img-fluid" id="btnPBack" src="../sources/back.png" alt="back" onclick="salir()">
		</a>
        <input type="image" class="img-fluid" id="btnPPlay" src="../sources/play.png" alt="play" data-bs-dismiss="modal" onclick="PlayGame()">
      </div>
    </div>
  </div>
</div>

<!-- Modal Victory-->
<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background-color: rgba(0,0,0,.0001) !important; border: rgba(0,0,0,.0001) !important;">
            <div class="modal-body">
                <div class="row">
                    <div>
                        <form id="formusername" class="mb-2">
                            <div class="form-group mb-2">
                            	<input id="scoreVictory" type="number" value="" readonly>
                                <label id="userinp" for="usernameinput">SHARE YOUR SCORE</label>
                                <input type="text" class="form-control" id="usernameinput" placeholder="Enter an Username">
                                <input type="image" class="img-fluid" id="btnUp" src="../sources/subir.png" alt="subir" data-bs-dismiss="modal" onclick="writeData()">
                                <button id="btnFB" type="button" class="btn btn-primary" onclick="shareFB()">Compartir en Facebook</button>
                            </div>
                        </form>
                    </div>
                    <div class="col">
                        <img id="titlevictory" src="../sources/victory.png" class="img-fluid">
                        <img id="sigVictory" class="img-fluid" src="../sources/victorysignal.png">
                        <a href="Beginplay.html"><input type="image" class="img-fluid" id="btnVBack" src="../sources/back.png" alt="next"></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal Lose-->
<div class="modal fade" id="exampleModal3" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background-color: rgba(0,0,0,.0001) !important; border: rgba(0,0,0,.0001) !important;">
            <div class="modal-body">
                <img id="titlelose" src="../sources/lose.png" class="img-fluid">
                <input id="scoreLose" type="number" value="0" readonly>
                <img id="sigLose" class="img-fluid" src="../sources/losesignal2.png">
                <a href="Beginplay.html"><input type="image" class="img-fluid" id="btnLBack" src="../sources/back.png" alt="back"></a>
            </div>
        </div>
    </div>
</div>

</body>
<!--Para Bootsrap-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script>
</html>